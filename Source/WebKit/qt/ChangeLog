2011-02-24  Peter Kasting  <pkasting@google.com>

        Reviewed by Eric Seidel.

        Drop the "U; " encryption level from the User Agent string.
        https://bugs.webkit.org/show_bug.cgi?id=54566

        * Api/qwebpage.cpp:
        (QWebPage::userAgentForUrl):

2011-02-24  Andrew Wilson  <atwilson@chromium.org>

        Unreviewed, rolling out r79570.
        http://trac.webkit.org/changeset/79570
        https://bugs.webkit.org/show_bug.cgi?id=54874

        Breaks chromium build because glue/mocks/mock_web_frame.h/cc
        was not updated

        * WebCoreSupport/DumpRenderTreeSupportQt.cpp:
        * WebCoreSupport/DumpRenderTreeSupportQt.h:

2011-02-24  Vsevolod Vlasov  <vsevik@chromium.org>

        Reviewed by Alexey Proskuryakov.

        DumpRenderTree should reset frame opener between tests.
        https://bugs.webkit.org/show_bug.cgi?id=54874

        Added clearOpener method to DumpRenderTreeSupportQT.

        * WebCoreSupport/DumpRenderTreeSupportQt.cpp:
        (DumpRenderTreeSupportQt::clearOpener):
        * WebCoreSupport/DumpRenderTreeSupportQt.h:

2011-02-24  Alexis Menard  <alexis.menard@openbossa.org>

        Reviewed by Andreas Kling.

        [Qt] tst_QWebView::setPalette(activeFG) fails
        https://bugs.webkit.org/show_bug.cgi?id=55029

        This time it should be the proper fix. The window needs to be shown before we
        call activateWindow() otherwise there is no active windows for the application.

        * tests/qwebview/tst_qwebview.cpp:
        (tst_QWebView::setPalette):

2011-02-24  Andras Becsi  <abecsi@webkit.org>

        Reviewed by Laszlo Gombos.

        [Qt] MinGW build fails to link
        https://bugs.webkit.org/show_bug.cgi?id=55050

        Prepend the libraries of subcomponents instead of appending them
        to fix the library order according to the dependency of the libraries

        * QtWebKit.pro: prepend libraries in the correct order

2011-02-23  Alexis Menard  <alexis.menard@openbossa.org>

        Reviewed by Ariya Hidayat.

        [Qt] tst_QWebView::setPalette(activeFG) fails
        https://bugs.webkit.org/show_bug.cgi?id=55029

        Attempt to make the test more robust. By investigating with the bot virtual machine
        I discovered that the activation can take some time. In this patch we make sure that
        the active window we want to have is the same as the QApplication.

        * tests/qwebview/tst_qwebview.cpp:
        (tst_QWebView::setPalette):

2011-02-23  Alexis Menard  <alexis.menard@openbossa.org>

        Reviewed by Dan Bernstein.

        [Qt]REGRESSION(r79167): It broke 3 Qt-API test cases
        http://trac.webkit.org/changeset/79167 refactored the way the bound size of
        the frame is handled. A new API setBoundsSize was added, we need to call it
        in addition to setFrameRect. I could call setBoundSize after setFrameRect but
        I thought It would be more elegant to use the resize method.

        * Api/qwebpage.cpp:
        (QWebPage::setViewportSize):

2011-02-22  Fabrizio Machado  <fabrizio.machado@nokia.com>

        Reviewed by Laszlo Gombos.

        [Qt] Don't fall through case in variantToSetting() if qvariant.type() is Bool
        https://bugs.webkit.org/show_bug.cgi?id=54976

        Test not needed.
        
        * WebCoreSupport/InspectorClientQt.cpp:

2011-02-22  Alexis Menard  <alexis.menard@openbossa.org>

        Reviewed by Andreas Kling.

        [Qt] QWebView ignores a palette set with QWebView::setPalette()
        https://bugs.webkit.org/show_bug.cgi?id=31742

        Test case to check that the palette sets on the QWebView is taken
        into account.

        * tests/qwebview/tst_qwebview.cpp:
        (tst_QWebView::setPalette_data):
        (tst_QWebView::setPalette):

2011-02-22  Laszlo Gombos  <laszlo.1.gombos@nokia.com>

        Reviewed by Alexey Proskuryakov.

        Drop the language tag part from the User Agent string
        https://bugs.webkit.org/show_bug.cgi?id=54560

        * Api/qwebpage.cpp:
        (QWebPage::userAgentForUrl):

        * tests/qwebpage/tst_qwebpage.cpp: Remove the userAgentLocaleChange
        test.

2011-02-22  Chang Shu  <cshu@webkit.org>

        Reviewed by Csaba Osztrogon치c.

        [Qt] editing/deleting/5408255.html fails
        https://bugs.webkit.org/show_bug.cgi?id=54964

        Move WebCore resource file to QtWebKit since they are referred in WebKit.

        * QtWebKit.pro:

2011-02-22  Andras Becsi  <abecsi@webkit.org>

        Reviewed by Csaba Osztrogon치c.

        [Qt] Redesign the build system
        https://bugs.webkit.org/show_bug.cgi?id=51339

        Move inspector's resource files into the final build step to fix the layout test regression.

        * QtWebKit.pro: Add inspector's reaource files.

2011-02-22  Andras Becsi  <abecsi@webkit.org>

        Reviewed by Laszlo Gombos.
        Rubber-stamped by Csaba Osztrogon치c.

        [Qt] Redesign the build system
        https://bugs.webkit.org/show_bug.cgi?id=51339

        The patch landed in r79320 didn't contain the cleanup
        which was already addressed in the last attachment.

        * QtWebKit.pro: Move common LIB and CONFIG options to WebCore.pri.

2011-02-22  Andras Becsi  <abecsi@webkit.org>

        Reviewed by Laszlo Gombos.

        [Qt] Redesign the build system
        https://bugs.webkit.org/show_bug.cgi?id=51339

        Part 2.

        Build WebCore as a static library, compile the WebKit API and WebKit2 API
        in a final step and link to WebKit2, WebCore and JSC libraries to fix
        linking issues resulting from stripped away symbols.

        * QtWebKit.pro: Added.
        Project file for the final build step.

2011-02-17  Ryosuke Niwa  <rniwa@webkit.org>

        Reviewed by Kent Tamura.

        Rename Position::node() to Position::deprecatedNode()
        https://bugs.webkit.org/show_bug.cgi?id=54622

        Replaced the call to node() by a call to containerNode() because the returned node is
        used to determine whether or not the selected contents are editable and such a check
        must be done against the container node.

        * WebCoreSupport/EditorClientQt.cpp:
        (WebCore::EditorClientQt::handleKeyboardEvent):

2011-02-19  Charlie Reis  <creis@chromium.org>

        Reviewed by Mihai Parparita.

        Ensure loading has stopped in HistoryController::goToItem
        https://bugs.webkit.org/show_bug.cgi?id=54517

        Add a FrameLoaderClient callback for whether to stop loading before goToItem.

        Test: http/tests/navigation/forward-to-fragment-fires-onload.html

        * WebCoreSupport/FrameLoaderClientQt.cpp:
        (WebCore::FrameLoaderClientQt::shouldStopLoadingForHistoryItem): Added.
        * WebCoreSupport/FrameLoaderClientQt.h:

2011-02-18  Fabrizio Machado  <fabrizio.machado@nokia.com>

        Reviewed by Eric Seidel.

        Remove reduntant checks.
        https://bugs.webkit.org/show_bug.cgi?id=54764
        

        * WebCoreSupport/DumpRenderTreeSupportQt.cpp:
        (DumpRenderTreeSupportQt::elementDoesAutoCompleteForElementWithId):
        * WebCoreSupport/NotificationPresenterClientQt.cpp:
        (WebCore::NotificationPresenterClientQt::toPage):

2011-02-18  Csaba Osztrogon치c  <ossy@webkit.org>

        Unreviewed.

        [Qt] Buildfix for platforms with geolocation disabled.

        * Api/qwebpage.cpp: Add the missing guard.

2011-02-18  Mahesh Kulkarni  <mahesh.kulkarni@nokia.com>

        Reviewed by Kenneth Rohde Christiansen.

        [Qt] Implement client based geolocation for qtport
        https://bugs.webkit.org/show_bug.cgi?id=42629

        Implements client based geolocation for qtwebkit.
        New client based geolocation contains permission API's as well,
        so removed the implementation from ChromeClientQt.cpp. 

        * Api/qwebpage.cpp:
        (QWebPagePrivate::QWebPagePrivate):
        * WebCoreSupport/ChromeClientQt.cpp:
        * WebCoreSupport/ChromeClientQt.h:
        (WebCore::ChromeClientQt::requestGeolocationPermissionForFrame):
        (WebCore::ChromeClientQt::cancelGeolocationPermissionRequestForFrame):
        * WebCoreSupport/GeolocationClientQt.cpp: Added.
        (WebCore::GeolocationClientQt::GeolocationClientQt):
        (WebCore::GeolocationClientQt::~GeolocationClientQt):
        (WebCore::GeolocationClientQt::geolocationDestroyed):
        (WebCore::GeolocationClientQt::positionUpdated):
        (WebCore::GeolocationClientQt::startUpdating):
        (WebCore::GeolocationClientQt::stopUpdating):
        (WebCore::GeolocationClientQt::setEnableHighAccuracy):
        (WebCore::GeolocationClientQt::requestPermission):
        (WebCore::GeolocationClientQt::cancelPermissionRequest):
        * WebCoreSupport/GeolocationClientQt.h: Added.
        (WebCore::GeolocationClientQt::lastPosition):

2011-02-10  Luiz Agostini  <luiz.agostini@openbossa.org>

        Reviewed by Adam Roben.

        HTML5 <details> and <summary>: localized text
        https://bugs.webkit.org/show_bug.cgi?id=54260

        The method defaultDetailsSummaryText was added to LocalizationStrategy class. It is used to
        provide the default label to be used by a <details> tag that has no <summary> child.

        * WebCoreSupport/WebPlatformStrategies.cpp:
        (WebPlatformStrategies::defaultDetailsSummaryText):
        * WebCoreSupport/WebPlatformStrategies.h:

2011-02-17  Hui Huang  <hui.2.huang@nokia.com>

        Reviewed by Laszlo Gombos.

        The URL of HTML5 Video Element is percent encoded at websites such as youtube.
        It is percent encoded again by QUrl constructor QUrl::QUrl(QString). This causes
        the HTTP GET request for the video to be rejected by the service provider. 
        https://bugs.webkit.org/show_bug.cgi?id=53973.

        The bug is fixed by constructing QUrl from the encoded URL in 
        MediaPlayerPrivateQt::commitLoad. 

        New test function tst_QWebPage::loadHtml5Video() is added to load HTML content with
        HTML5 Video element. A new public method DumpRenderTreeSupportQt::mediaContentUrlByElementId
        is added to retrieve the URL of the media content from WebCore MediaPlayerPrivateQt.
        A new macro ENABLE_QT_MULTIMEDIA is introduced in tests.pri to make sure that the test
        is skipped if Qt Multimedia is not available.

        * WebCoreSupport/DumpRenderTreeSupportQt.cpp:
        (DumpRenderTreeSupportQt::mediaContentUrlByElementId):
        * WebCoreSupport/DumpRenderTreeSupportQt.h:
        * tests/qwebpage/tst_qwebpage.cpp:
        (tst_QWebPage::loadHtml5Video):
        * tests/tests.pri:

2011-02-17  Andreas Kling  <kling@webkit.org>

        Reviewed by Antti Koivisto.

        [Qt] Crash when calling QWebFrame::setUrl() while a previous load has pending requests
        https://bugs.webkit.org/show_bug.cgi?id=49216

        * tests/qwebframe/tst_qwebframe.cpp:

== Rolled over to ChangeLog-2011-02-16 ==
